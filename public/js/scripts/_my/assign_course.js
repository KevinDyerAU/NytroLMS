!function(e){"use strict";let t="Australia/Sydney";moment.tz.setDefault(t);var a=$(".select2"),n=(new Date,$(".source-item")),o=$(".btn-add-new "),r=$(".date-picker");const s=$("#assign-course-form").data("backdate");a.each((function(){var e=$(this);e.wrap('<div class="position-relative form-select-control'+e.data("class")+'"></div>'),e.select2({dropdownAutoWidth:!0,width:"100%",dropdownParent:e.parent(),allowClear:!0}),e.on("select2:select",(function(e){const t=e.params.data;$(t.element).parent().parent().parent().parent().find(".date-picker").prop("disabled",!1)}))})),n.length&&($("#assign-course-form").on("submit",(function(e){e.preventDefault()})),n.repeater({isFirstItemUndeletable:!0,show:function(){$(this).slideDown(),$("#assign-course-form .select2-container").remove(),$("#assign-course-form .select2").each((function(){var e=$(this);e.addClass("xyz"),e.removeClass("select2-hidden-accessible"),e.wrap('<div class="position-relative form-select-control'+e.data("class")+'"></div>'),e.select2({dropdownAutoWidth:!0,width:"100%",dropdownParent:e.parent(),allowClear:!0}),e.on("select2:select",(function(e){const t=e.params.data;$(t.element).parent().parent().parent().parent().find(".date-picker").prop("disabled",!1)}))})),$("#assign-course-form .date-picker").each((function(){const e=$(this).data("backdate");$(this).flatpickr({minDate:s||void 0!==e&&e?new Date("2022-01-01"):new Date,altFormat:"DD-MM-YYYY",altInput:!0,dateFormat:"YYYY-MM-DD\\\\THH:mm:ssZ",parseDate(e,a){let n=new moment.tz(e,a,t);return new Date(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second())},formatDate:(e,a)=>moment.tz([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()],t).locale("en-GB").format(a),onChange:function(e,a,n){let o=$(n.element).parent().parent(),r=o.find(".select2").find(":selected").data("length"),s=e[0];s.setDate(s.getDate()+r),o.find(".date-picker-end").prop("disabled",!1),o.find(".date-picker-end").flatpickr({defaultDate:s,altFormat:"DD-MM-YYYY",altInput:!0,dateFormat:"YYYY-MM-DD\\\\THH:mm:ssZ",parseDate(e,a){let n=new moment.tz(e,a,t);return new Date(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second())},formatDate:(e,a)=>moment.tz([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()],t).locale("en-GB").format(a)})}})}))},hide:function(e){$(this).slideUp().remove()}})),o.length&&o.on("click",(function(){})),r.length&&(r.each((function(){const e=$(this).data("backdate");$(this).flatpickr({minDate:s||void 0!==e&&e?new Date("2022-01-01"):new Date,altFormat:"DD-MM-YYYY",altInput:!0,dateFormat:"YYYY-MM-DD\\\\THH:mm:ssZ",parseDate(e,a){let n=new moment.tz(e,a,t);return new Date(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second())},formatDate:(e,a)=>moment.tz([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()],t).locale("en-GB").format(a),onChange:function(e,a,n){let o=$(n.element).parent().parent(),r=o.find(".select2").find(":selected").data("length"),s=e[0];s.setDate(s.getDate()+r),o.find(".date-picker-end").prop("disabled",!1),o.find(".date-picker-end").flatpickr({defaultDate:s,altFormat:"DD-MM-YYYY",altInput:!0,dateFormat:"YYYY-MM-DD\\\\THH:mm:ssZ",parseDate(e,a){let n=new moment.tz(e,a,t);return new Date(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second())},formatDate:(e,a)=>moment.tz([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()],t).locale("en-GB").format(a)}),$("#course").on("select2:select",(function(e){$("#course_start_at").val(""),$("#course_ends_at").val("")}));let i=$("#course").find(":selected").data("length"),l=new Date($("#course_start_at").val());$("#course_ends_at").flatpickr({defaultDate:l.setDate(l.getDate()+i),altFormat:"DD-MM-YYYY",altInput:!0,dateFormat:"YYYY-MM-DD\\\\THH:mm:ssZ",parseDate(e,a){let n=new moment.tz(e,a,t);return new Date(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second())},formatDate:(e,a)=>moment.tz([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()],t).locale("en-GB").format(a)})}})})),$(".date-picker-end").each((function(){let e=$(this).data("mindate");$(this).flatpickr({defaultDate:e,altFormat:"DD-MM-YYYY",altInput:!0,dateFormat:"YYYY-MM-DD\\\\THH:mm:ssZ",parseDate(e,a){let n=new moment.tz(e,a,t);return new Date(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second())},formatDate:(e,a)=>moment.tz([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()],t).locale("en-GB").format(a)})})));var i=$("#assign-course-form");if(i.length){function l(){const t=i.serialize();axios.post("/api/v1/students/"+i.find('input[name="student_id"]').val()+"/assign_course",t).then((t=>{toastr.success("",t.data.message,{closeButton:!0,tapToDismiss:!0}),e.location.href.indexOf("edit")>0?$("#assign-course-sidebar").modal("hide"):e.location.reload()})).catch((e=>{console.log(e.response)}))}$("#proceed-btn").on("click",(function(e){e.preventDefault(),i.valid()&&$("#confirm-notification-modal").modal("show")})),$("#confirm-yes").on("click",(function(){$("#notify_leader").val("1");var e=$("#email-course-ids-container");e&&e.length&&(e.empty(),$(".modal-email-course:checked").each((function(){var t=$(this).val();t&&$("<input />",{type:"hidden",name:"email_course_ids[]",value:t}).appendTo(e)}))),$("#confirm-notification-modal").modal("hide"),l()})),$("#confirm-notification-modal .btn-secondary").on("click",(function(){$("#notify_leader").val("0"),$("#confirm-notification-modal").modal("hide"),l()})),i.validate({ignore:""})}}(window);
